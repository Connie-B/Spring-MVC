<html>
<body>
  <form>
    <th:block th:fragment="input (label, name, type)">
      <div th:with="valid=${!#fields.hasErrors(name)}"
        th:class="${'form-group' + (valid ? '' : ' has-danger')}">
        <label class="col-sm-2 control-label" th:text="${label}">Label</label>
        <div class="col-sm-10">
            <div th:switch="${type}">
                <input th:case="'text'" th:class="${'form-control' + (valid ? '' : ' is-invalid')}" type="text" th:field="*{__${name}__}" th:readonly="${'create' == action || 'edit' == action} ? false : true"/>
                <input th:case="'date'" th:class="${'form-control' + (valid ? '' : ' is-invalid')}" type="date" th:field="*{__${name}__}" th:readonly="${'create' == action || 'edit' == action} ? false : true"/>
                <input th:case="'tel'" th:class="${'form-control' + (valid ? '' : ' is-invalid')}" type="tel" th:field="*{__${name}__}" th:readonly="${'create' == action || 'edit' == action} ? false : true"/>
                <input th:case="'email'" th:class="${'form-control' + (valid ? '' : ' is-invalid')}" type="email" th:field="*{__${name}__}" th:readonly="${'create' == action || 'edit' == action} ? false : true"/>
                <div th:if="${!valid}" class="invalid-feedback" th:errors="*{__${name}__}">Error</div>
              </div>
        </div>
      </div>
    </th:block>
  </form>
</body>
</html>
